# Asynchronous JavaScript

### 1. 비동기 (Synchoronous 가 아닌 것)

- Synchoronous(동기) 
  - 프로그램의 실행 흐름이 순차적으로 진행
  - 하나의 작업이 완료되 후에 다음 작업이 실행되는 방식
  - **꼭 기억해야 될 특징 : 순서가 보장이 된다**

![1](https://github.com/JeongJonggil/TIL/assets/139416006/5f5eed81-f1f4-4a0d-9cd9-99dbf31434a0)

- Asynchronous(비동기)
  - 프로그램의 실행 흐름이 순차적이지 않으며, 작업이 완료되기를 기다리지 않고 다음 작업이 실행되는 방식
  - 작업의 완려 여부를 신경 쓰지 않고 동시에 다른 작업들을 수행할 수 있음
  - **동시에 코드를 처리하는게 아님.** 순서를 바꿔서 코드를 처리 하는 거임
  
  - 특징
    - 병렬적 수행
    - 당장 처리를 완료할 수 없고 시간이 필요한 작업들은 별도로 요청을 보낸 뒤 응답이 빨리 오는 작업부터 처리
  - 예시
    - Gmail에서 메일 전송을 누르면 목록 화면으로 전환되지만 실제로 메일을 보내는 작업은 병렬적으로 별도로 처리됨
    - 브라우저는 웹 페이지를 먼저 처리되는 요소부터 그려 나가며 처리가 오래 걸리는 것들은 별도로 처리가 완료 되는대로 병렬적으로 처리

### 2. 자바스크립트와 비동기

- 자바스크립트는 Single Thread 언어
  - Thread : 작업을 처리할 때 실제로 작업을 수행하는 주체로, multi-thread라면 업무를 수행할 수 있는 주체가 여러 개라는 의미
  - 즉, 자바스크립트는 하나의 작업을 요청한 순서대로 처리할 수 밖에 없음
- **자바스크립트 Runtime**
  - 자바스크립트가 동작할 수 있는 환경(Runtime)
  - **자바스크립트 자체는 Single Thread이므로 비동기 처리를 할 수 있도록 도와주는 환경이 필요**
  - 자바스크립트에서 비동기와 관련한 작업은 "브라우저" 또는 "Node"와 같은 환경에서 처리
- 브라우저 환경에서의 자바스크립트 비동기 처리 관련 요소
  - Call Stack (자바스크립트의 Engine)
    - 요청이 들어올 때 마다 순차적으로 처리하는 Stack(LIFO)
    - 기본적인 자바스크립트의 Single Thread 작업 처리
  - Web API
    - 자바스크립트 엔진이 아닌 브라우저에서 제공하는 runtime 환경
    - 시간이 소요되는 작업을 처리 (setTimeout, DOM Event, AJAX 요청 등)
  - Task Queue
    - 비동기 처리된 Callback 함수가 대기하는 Queue(FIFO)
  - Event Loop
    - 태스크(작업)가 들어오길 기다렸다가 태스크가 들어오면 이를 처리하고, 처리할 태스크가 없는 경우엔 잠드는, 끊임없이 돌아가는 자바스크립트 내 루프
    - Call Stack과 Task Queue를 지속적으로 모니터링
    - Call Stack이 비어 있는지 확인 후 비어 있다면 Task Queue에서 대기중인 오래된 작업을 Call Stack으로 Push
- **정리**
  - 자바스크립트는 한 번에 하나의 작업을 수행하는 Single Thread 언어로 동기적 처리를 진행
  - 하지만 브라우저 환경에서는 Web API에서 처리된 작업이 지속적으로 Task Queue를 거쳐 Event Loop에 의해 Call Stack에 들어와 순차적으로 실행됨으로써 비동기 작업이 가능한 환경이 됨



### 3. 브라우저 환경에서의 자바스크립트 비동기 처리 동작 방식

- 모든 작업은 **Call Stack**(LIFO)으로 들어간 후 처리된다. (Call Stack에 들어갔다가 호출되면서(=나오면서) 코드의 동작이 처리됨)
- 오래 걸리는 작업이 Call Stack으로 들어오면 **Web API**로 보내 별도로 처리하도록 한다.
- Web API에서 처리가 끝난 작업들은 곧바로 Call Stack으로 들어가지 못하고 **Task Queue(FIFO)**에 순서대로 들어간다.
- **Event Loop**가 Call Stack이 비어 있는 것을 계속 체크하고 Call Stack이 빈다면 Task Queue에서 가장 오래된(가장 먼저 처리되어 들어온) 작업을 Call Stack으로 보낸다.

> ※참고1 : 코드들이 동기적으로 실행될 때 콜 스택에 차례대로 들어갔다 나오게 됨. 하지만, 이 동안 콜 스택은 실제로 "비어 있지 않음". 즉, **하나의 동기적 작업이 끝나고 다른 동기적 작업이 시작되기까지의 사이에는 극히 짧은 시간이지만 콜 스택은 항상 무언가를 처리하고 있는 상태**이기 때문. → Task Queue에 대기중인 작업이 있다고 가정했을 때, x 작업이 Call Stack에서 나오고  y 작업이 Call Stack에 들오기 전인 Call Stack이 잠깐 비는 순간에 Task Queue에 있던 작업이 Call Stack으로 올라가지 않을까? 싶었는데 **결론은 Call Stack은 동기적 코드들의 실행이 완전히 끝날 때까지 비는 순간이 없음.**
>
> ※참고2 : setTimeout 등 비동기 함수에서 설정한 시간은 해당 시간이 지난후에 동작이 실행된다는 뜻이 아니고 Task Queue에 들어간다는게 정확한 의미임

@@@@@@@@@@1~13





### 4. AJAX (Asynchronous JavaScript + XML)

- **자바스크립트의 비동기 구조와 XML 객체를 활용해 비동기적으로 서버와 통신하여 웹 페이지의 일부분만을 업데이트하는 웹 개발 기술**
- 'X'가 XML을 의미하긴 하지만 요즘은 더 가벼운 용량과 자바스크립트의 일부라는 장점 때문에 'JSON'을 더 많이 사용

#### (1) XML HttpRequest 객체 (XHR 객체)

- 서버와 상호작용할 때 사용하며 페이지의 새로고침 없이도 URL에서 데이터를 가져올 수 잇음

- 사용자의 작업을 방해하지 않고 페이지의 일부를 업데이트
- 주로 AJAX 프로그래밍에 많이 사용됨

#### (2) 이벤트 핸들러는 비동기 프로그래밍의 한 형태

- 이벤트가 발생할 때마다 호출되는 함수(콜백 함수)를 제공하는 것
- XMLHttpRequest(XHR)는 자바스크립트를 사용하여 서버에 HTTP 요청을 할 수 있는 객체
- HTTP 요청은 응답이 올 때 까지의 시간이 걸릴 수 있는 작업이라 비동기 API이며, 이벤트 핸들러를 XHR 객체에 연결해 요청의 진행 상태 및 최종 완료에 대한 응답을 받음

### 5.Axious

- JavaScript에서 사용되는 HTTP 클라이언트 라이브러리
- 서버와의 HTTP 요청과 응답을 간편하게 처리할 수 있도록 도와주는 도구
